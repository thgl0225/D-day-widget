<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D-day ì¹´ìš´í„°</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- ë³€ìˆ˜ ì„¤ì • (ì‚¬ìš©ì ì„¤ì • ê°€ëŠ¥) --- */
        :root {
            --theme-main: #ff80ab; 
            --theme-shadow-rgb: 255, 128, 171; 
            --dday-start-color: #ff99cc; 
            --dday-end-color: #ff80ab;
            --soft-bg: #fce4ec; 
            --modal-bg: #fff0f7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /* ê¸°ë³¸ í°íŠ¸: Gowun Batang (ê³ ìš´ ë°”íƒ•) ìœ ì§€ */
            font-family: 'Gowun Batang', 'Poppins', sans-serif; 
            background: none; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 15px;
            position: relative;
        }

        /* --- ëª¨ë‹¬ (íŒì—…ì°½) ìŠ¤íƒ€ì¼ --- */
        .modal-backdrop { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.15); z-index: 100; justify-content: center; align-items: center; }
        .modal-content { background: var(--modal-bg); padding: 20px; border-radius: 15px; box-shadow: 0 5px 20px rgba(var(--theme-shadow-rgb), 0.3); text-align: center; width: 150px; border: 2px solid var(--theme-main); transform: scale(0.95); }
        .modal-message { font-size: 11px; color: #444; margin-bottom: 15px; font-weight: 600; }
        .modal-button { 
            padding: 6px 15px; background: var(--theme-main); color: white; border: none; border-radius: 15px; font-size: 10px; font-weight: 700; cursor: pointer; transition: background 0.2s; 
            font-family: 'Gowun Batang', sans-serif; 
        }
        .modal-button:hover { background: rgba(var(--theme-shadow-rgb), 0.8); }
        #settingsModal .modal-content { width: 170px; padding: 15px; }
        #settingsModal h4 { font-size: 13px; color: var(--theme-main); margin-bottom: 10px; font-weight: 700; }
        .setting-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .setting-label { font-size: 10px; color: #555; font-weight: 600; }
        #settingsModal .modal-button { width: 100%; margin-top: 5px; padding: 8px; font-size: 11px; }
        #settingsModal input[type="color"] { width: 20px; height: 20px; padding: 0; border: 2px solid #ffffff; border-radius: 50%; cursor: pointer; background-color: var(--theme-main); margin-left: 10px; -webkit-appearance: none; -moz-appearance: none; appearance: none; box-shadow: 0 0 3px rgba(0, 0, 0, 0.2); }
        #settingsModal input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        #settingsModal input[type="color"]::-webkit-color-swatch { border: none; border-radius: 50%; }
        
        /* --- ìœ„ì ¯ ì»¨í…Œì´ë„ˆ --- */
        .container { background: none; padding: 0; width: 100%; max-width: 180px; box-shadow: none; border: none; display: flex; flex-direction: column; align-items: center; }
        
        /* ë“¤ì—¬ì“°ê¸° ìœ ì§€ */
        .input-group { margin-bottom: 8px; padding-left: 5px; }
        
        label { display: block; margin-bottom: 4px; color: var(--theme-main); font-weight: 700; font-size: 10px; letter-spacing: 0.5px; }
        #inputForm { background: #ffffff; border-radius: 12px; padding: 10px; box-shadow: 0 4px 10px rgba(var(--theme-shadow-rgb), 0.2); border: 2px solid var(--soft-bg); width: 100%; position: relative; }
        
        /* --- í…ìŠ¤íŠ¸ ë° ë‚ ì§œ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ --- */
        input[type="text"],
        input[type="date"] {
            width: 100%;
            padding: 6px 10px;
            border: 2px solid var(--soft-bg);
            border-radius: 12px;
            font-size: 10px;
            background: #fffafa;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: 'Gowun Batang', sans-serif; 
        }

        input:focus { outline: none; border-color: var(--theme-main); box-shadow: 0 0 5px rgba(var(--theme-shadow-rgb), 0.5); }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: none; cursor: pointer; opacity: 1.0; }
        
        /* --- ì„¤ì • ë²„íŠ¼ (í°íŠ¸ í†µì¼) --- */
        button:not(.setting-btn, .modal-button) {
            width: 100%;
            padding: 8px;
            background: var(--theme-main);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 4px 8px rgba(var(--theme-shadow-rgb), 0.4);
            margin-top: 4px; 
            cursor: pointer;
            font-family: 'Gowun Batang', sans-serif; 
        }

        button:not(.setting-btn, .modal-button):hover { transform: translateY(-2px); background: rgba(var(--theme-shadow-rgb), 0.8); box-shadow: 0 6px 12px rgba(var(--theme-shadow-rgb), 0.6); }

        /* --- D-day í‘œì‹œ ì˜ì—­ --- */
        .dday-display { margin-top: 12px; text-align: center; display: none; border-radius: 20px; padding: 12px; background: #fff; box-shadow: 0 4px 12px rgba(var(--theme-shadow-rgb), 0.3); border: 2px dashed var(--soft-bg); width: 100%; position: relative; }
        .dday-display.show { display: block; }
        
        /* ê°„ê²© ë° ì œëª© í¬ê¸° ìœ ì§€ */
        .event-name { 
            font-size: 15px; 
            color: #444; 
            margin-bottom: 3px; 
            font-weight: 600; 
        }
        
        /* ğŸŒŸ D-day ìˆ«ì í°íŠ¸: Poppins (Bold) ì ìš© ğŸŒŸ */
        .dday-number { 
            font-size: 30px;
            font-weight: 700; /* Poppins Bold êµµê¸° */
            font-family: 'Poppins', sans-serif; /* ğŸŒŸ Poppins í°íŠ¸ ì ìš© ğŸŒŸ */
            background: linear-gradient(135deg, var(--dday-start-color) 0%, var(--dday-end-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 3px 0; 
            text-shadow: 0 0 5px rgba(var(--theme-shadow-rgb), 0.4);
        }
        
        .target-date { font-size: 11px; color: #777; margin-top: 6px; font-style: italic; }
        
        /* --- ì„¤ì • í†±ë‹ˆë°”í€´ ë²„íŠ¼ --- */
        .setting-btn { background: none; color: var(--theme-main); font-size: 14px; opacity: 0.6; font-weight: normal; width: auto; padding: 0; margin: 0; border: none; box-shadow: none; position: absolute; top: 4px; right: 4px; transition: opacity 0.2s, transform 0.2s; cursor: pointer; z-index: 50; }
        .setting-btn:hover { opacity: 1.0; color: var(--theme-main); transform: rotate(15deg); }
        
    </style>
</head>
<body onload="updateThemeColor()">
    <div class="container">
        
        <div id="inputForm">
            <button class="setting-btn" onclick="showSettingsModal()">âš™ï¸</button>
            
            <div class="input-group">
                <label for="eventName">ì´ë²¤íŠ¸ ì´ë¦„</label>
                <input type="text" id="eventName" placeholder="ì˜ˆ: ìƒì¼, ì¤‘ìš”í•œ ë‚ ">
            </div>
            <div class="input-group">
                <label for="targetDate">ëª©í‘œ ë‚ ì§œ</label>
                <input type="date" id="targetDate">
            </div>
            
            <button onclick="setDday()">D-day ì„¤ì •</button>
        </div>

        <div id="ddayDisplay" class="dday-display">
            <button class="setting-btn" onclick="showSettingsModal()">âš™ï¸</button>
            <div class="event-name" id="displayEventName"></div>
            <div class="dday-number" id="ddayNumber"></div>
            <div class="target-date" id="displayTargetDate"></div>
        </div>
    </div>
    
    <div id="settingsModal" class="modal-backdrop" onclick="hideModal(event, 'settingsModal')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h4>ìœ„ì ¯ ì„¤ì •</h4>
            <div class="setting-row">
                <span class="setting-label">í…Œë§ˆ ìƒ‰ìƒ ë³€ê²½</span>
                <input type="color" id="themeColor" value="#ff80ab" oninput="updateThemeColor()">
            </div>
            <button class="modal-button" onclick="resetDday()">ì…ë ¥ ì´ˆê¸°í™” (ì¬ì„¤ì •)</button>
            <button class="modal-button" onclick="hideModal(null, 'settingsModal')" style="margin-top: 10px;">ë‹«ê¸°</button>
        </div>
    </div>

    <div id="modalAlert" class="modal-backdrop" onclick="hideModal(event, 'modalAlert')">
        <div class="modal-content">
            <div class="modal-message" id="modalMessage"></div>
            <button class="modal-button" onclick="hideModal(null, 'modalAlert')">í™•ì¸</button>
        </div>
    </div>

    <script>
        const data = { eventName: '', targetDate: '' };
        const root = document.documentElement;
        
        function hexToRgb(hex) {
            const bigint = parseInt(hex.slice(1), 16);
            const r = (bigint >> 16) & 255;
            const g = (bigint >> 8) & 255;
            const b = bigint & 255;
            return `${r}, ${g}, ${b}`;
        }
        
        function updateThemeColor() {
            const newColor = document.getElementById('themeColor').value;
            const rgb = hexToRgb(newColor);
            root.style.setProperty('--theme-main', newColor);
            root.style.setProperty('--theme-shadow-rgb', rgb);
            root.style.setProperty('--dday-start-color', newColor + '99'); 
            root.style.setProperty('--dday-end-color', newColor); 
        }

        function showModal(message) {
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('modalAlert').style.display = 'flex';
        }
        
        function showSettingsModal() {
            document.getElementById('settingsModal').style.display = 'flex';
        }

        function hideModal(event, modalId) {
            const modal = document.getElementById(modalId);
            if (event && event.target !== modal) {
                return;
            }
            modal.style.display = 'none';
        }

        function setDday() {
            const eventName = document.getElementById('eventName').value;
            const targetDate = document.getElementById('targetDate').value;
            if (!eventName || !targetDate) {
                showModal('ì´ë²¤íŠ¸ ì´ë¦„ê³¼ ë‚ ì§œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            data.eventName = eventName;
            data.targetDate = targetDate;
            updateDisplay();
        }

        function updateDisplay() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const target = new Date(data.targetDate);
            target.setHours(0, 0, 0, 0);
            
            const diffTime = target - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            document.getElementById('displayEventName').textContent = data.eventName;
            document.getElementById('displayTargetDate').textContent = target.toLocaleDateString('ko-KR');

            if (diffDays > 0) {
                document.getElementById('ddayNumber').textContent = `D-${diffDays}`;
            } else if (diffDays === 0) {
                document.getElementById('ddayNumber').textContent = 'D-DAY';
            } else {
                document.getElementById('ddayNumber').textContent = `D+${Math.abs(diffDays)}`;
            }

            document.getElementById('inputForm').style.display = 'none';
            document.getElementById('ddayDisplay').classList.add('show');
        }

        function resetDday() {
            hideModal(null, 'settingsModal');
            document.getElementById('eventName').value = '';
            document.getElementById('targetDate').value = '';
            document.getElementById('inputForm').style.display = 'block';
            document.getElementById('ddayDisplay').classList.remove('show');
        }

        // ê³¼ê±° ë‚ ì§œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ìœ ì§€
        document.getElementById('targetDate').removeAttribute('min');
        
        document.addEventListener('DOMContentLoaded', updateThemeColor);
    </script>
</body>
</html>
